# 무결성(Integrity)

> 파이널 프로젝트 도중 상품의 지역정보를 받아 와야했다. 작성한 ERD에 따르면 멤버 - 상점 - 상품의 참조를 통해서 가능했다.   
> 그래서 상품 테이블에 바로 지역정보 컬럼이 있으면 안되냐는 질문에 그 경우 무결성이 깨진다고 들어 짧게 정리해본다.

## 무결성이란 ❓
데이터의 정확성과 일관성을 유지하고 보증하는 것.<br />
[[참조출처 : 위키백과]](https://ko.wikipedia.org/wiki/%EB%8D%B0%EC%9D%B4%ED%84%B0_%EB%AC%B4%EA%B2%B0%EC%84%B1)

## 무결성의 유형

### 개체 무결성 (Entity Integrity)
모든 테이블은 기본 키(primary key)로 선택된 필드(column)을 가져야 한다.   
**기본 키** 로 선택된 필드는 고유한 값(중복된 값을 가지지 않으며)을 가져야하며, 빈 값(null)이 허용되지 않는다.

### 참조 무결성 (Referential Integrity)
참조 관계에 있는 두 테이블의 데이터는 항상 일관된 값을 갖도록 유지해야 한다.

### 도메인 무결성 (Domain Integrity)
필드의 타입, null값 허용 등에 대한 사항을 정의하고, 올바른 데이터가 입력되는지 확인하여야 한다.   
기본값 설정, 제약 조건 등으로 도메인 무결성을 보장하여야 한다.


## 외래키(Foreign key)와 참조 무결성
데이터 베이스는 참조 대상이 존재하지 않는 외래 키를 허용하지 않는다.<br/>
▶ 외래키 B가 A를 참조한다면, A는 **반드시** 데이터 베이스에 존재하여야 한다.
참조 무결성을 지키기 위해 DBMS에서 제공하는 옵션들  
 - Restrict : 레코드 변경 | 삭제하려 할 때 해당 레코드를 참조하고 있는 개체가 있다면 변경 | 삭제 연산을 취소한다.
 - Cascade : 레코드를 변경 | 삭제하면 참조하고 있는 해당 레코드도 변경 | 삭제 된다.
 - Set Null : 레코드를 변경 | 삭제하면 참조하고 있는 해당 레코드를 Null로 설정한다.

[[참조출처]](https://untitledtblog.tistory.com/123)

## 첫 궁금증으로 돌아와서
만약 상품의 지역 정보에 사용자의 지역 정보와 다른 값이 들어온다면??   
구현할 서비스에 따라 설정이 다르다.
 - 가입 시 지정한 지역에서만 거래 가능 ▶ 데이터 무결성이 깨질 가능성 존재
 - 가입 시 지정한 지역 외에서도 거래가 가능 ▶ 이 경우엔 컬럼을 추가해서 관리 